<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- <link rel="manifest" href="/manifest.json"> -->
        <title>CH</title>

        <!-- <link rel="icon" type="image/png" href="./CATT.png"> -->
        <style id="customCSS"></style>
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </head>
    <body style="padding:0px; margin:0px; height:100dvh;">

        <div id="customHTML" style="height:100%; overflow-y:auto; scrollbar-width:none; transition:all 0.3s ease-in-out;"></div>

        <script src="https://clarkeharrison.co.uk/kaplay.js"></script>
        <script src="https://clarkeharrison.co.uk/qrCode.js"></script>

        <script>

            let pages = {
    "Home": {
        "HTML": [
            "<div id=\"header\">\n    <button onclick=\"editPage('Home')\">Edit</button>\n    <button onclick=\"showPage('ClickandTreatTraining');\">ClickandTreatTraining</button>\n    <button onclick=\"editPage('Study Map')\">Study Map</button>\n    <button onclick=\"editPage('RPG Cards')\">RPG Cards</button>\n    <button onclick=\"if (prompt('Are you sure?') == 'Yes') indexedDB.deleteDatabase('pagesDB'); window.location.reload();\">Reset Changes</button>\n</div>\n\n<textarea id=\"notesArea\" style=\"width:calc(100% - 44px); height:300px; border:solid black 2px; margin:10px; padding:10px;\"></textarea>\n<br>\n<button onclick=\"showPage('KaplayTest')\">Kaplay Test</button>\n<button onclick=\"editPage('KaplayTest')\">Edit Kaplay Test</button>\n"
        ],
        "CSS": [
            "/* Main */\n\n#header {\n    width: calc(100% - 10px);\n    display: flex;\n    flex-direction: row-reverse;\n    gap: 10px;\n    padding: 5px;\n    background-color:gray;\n}\n\n\n\n\n"
        ],
        "JS": [
            "/* Main */\n\n\nconst notesArea = document.getElementById(\"notesArea\");\nconst cnv = document.createElement(\"canvas\");\nconst ctx = cnv.getContext(\"2d\");\n\n\nif (!(\"Notes\" in pages[\"Home\"])) pages[\"Home\"][\"Notes\"] = \"\";\nnotesArea.value = pages[\"Home\"][\"Notes\"];\nnotesArea.addEventListener(\"input\", function() {\n    pages[\"Home\"][\"Notes\"] = this.value;\n    savePages();\n});\n\n\nctx.fillStyle = \"red\";\nctx.fillRect(20,20,40,40);\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
            "/* Edit Page */\n\nwindow.editPage = function(pageName='Home') {\n    if (!(pageName in pages)) pages[pageName] = {\"HTML\" : [\"\"] , \"CSS\" : [\"\"] , \"JS\" : [\"\"]};\n\n    customHTML.innerHTML += `\n        <div style=\"width:calc(100% - 50px); height:calc(100% - 50px); display:flex; flex-direction:column; gap:10px; background-color:white; position:fixed; top:0px; z-index:10; border:solid black 5px; border-radius:8px; margin:10px; padding:10px;\">\n            <div style=\"width:100%; min-height:40px; height:40px; display:flex; gap:10px;\">\n                <button id=\"showHTMLText\" style=\"width:100%; height:100%; border-radius: 8px; box-shadow: 1px 1px 2px grey; font-size: 24px; background-color: white; cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent;\">HTML</button>\n                <button id=\"showCSSText\" style=\"width:100%; height:100%; border-radius: 8px; box-shadow: 1px 1px 2px grey; font-size: 24px; background-color: white; cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent;\">CSS</button>\n                <button id=\"showJSText\" style=\"width:100%; height:100%; border-radius: 8px; box-shadow: 1px 1px 2px grey; font-size: 24px; background-color: white; cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent;\">JS</button>\n            </div>\n            <div id=\"subTextArea\" style=\"min-width:100%; min-height:40px; height:40px; display:flex; gap:10px; overflow-x:auto; overflow-y:hidden; scrollbar-width:none;\"></div>\n            <textarea id=\"textEditArea\" wrap=\"off\" style=\"width:calc(100% - 24px); height:calc(100% - 22px); display:block; padding:10px; border:solid black 2px; resize:none;\"></textarea>\n            <div style=\"width:100%; min-height:40px; height:40px; display:flex; gap:10px;\">\n                <button id=\"showPageButton\" style=\"width:100%; height:100%; border-radius: 8px; box-shadow: 1px 1px 2px grey; font-size: 24px; background-color: white; cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent;\">Show Page</button>\n                <button id=\"savePageButton\" style=\"width:100%; height:100%; border-radius: 8px; box-shadow: 1px 1px 2px grey; font-size: 24px; background-color: white; cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent;\">Save</button>\n            </div>\n        </div>\n    `;\n\n    const showHTMLText = document.getElementById('showHTMLText');\n    const showCSSText = document.getElementById('showCSSText');\n    const showJSText = document.getElementById('showJSText');\n\n    const subTextArea = document.getElementById('subTextArea');\n\n    const textEditArea = document.getElementById('textEditArea');\n\n    const showPageButton = document.getElementById('showPageButton');\n    const savePageButton = document.getElementById('savePageButton');\n\n    let type = \"HTML\";\n    let textSection = 0;\n\n    showHTMLText.onclick = function() {showPageText(\"HTML\");};\n    showCSSText.onclick = function() {showPageText(\"CSS\");};\n    showJSText.onclick = function() {showPageText(\"JS\");};\n\n\n\n\n\n    function showPageText(typeOfPage, sec=0) {\n        if (textSection != 0 && textEditArea.value == \"\") {\n            pages[pageName][type].splice(textSection, 1);\n            if (sec >= textSection) sec -= 1;\n        }\n\n        type = typeOfPage;\n        textSection = sec;\n        subTextArea.innerHTML = \"\";\n\n        showHTMLText.style.border = (type == \"HTML\") ? \"solid blue 4px\" : \"solid black 1px\";\n        showCSSText.style.border = (type == \"CSS\") ? \"solid blue 4px\" : \"solid black 1px\";\n        showJSText.style.border = (type == \"JS\") ? \"solid blue 4px\" : \"solid black 1px\";\n\n        for (let i=0; i<pages[pageName][type].length; i++) {\n            let sectionButton = document.createElement(\"button\");\n            sectionButton.style.cssText = `height:100%; padding:0px 10px; border-radius: 8px; box-shadow: 1px 1px 2px grey; font-size: 24px; background-color: white; cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent; flex-shrink: 0;`;\n            sectionButton.style.border = (i == textSection) ? \"solid blue 4px\" : \"solid black 1px\";\n            const firstLine = pages[pageName][type][i].split(\"\\n\")[0];\n            sectionButton.innerHTML = (firstLine.startsWith(\"/*\") || firstLine.startsWith(\"<!\")) ? firstLine.slice(2,-2) : `${i}`;\n            sectionButton.onclick = function() {\n                showPageText(typeOfPage, i);\n            }\n            subTextArea.appendChild(sectionButton);\n        }\n\n        let newSectionButton = document.createElement(\"button\");\n        newSectionButton.style.cssText = \"height:100%; padding:0px 10px; border-radius: 8px; border:solid black 1px; box-shadow: 1px 1px 2px grey; font-size: 24px; background-color: white; cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent; flex-shrink: 0;\";\n        newSectionButton.innerHTML = '+';\n        newSectionButton.onclick = function() {\n            pages[pageName][type].push(\"\");\n            savePages();\n            showPageText(type, (pages[pageName][type].length - 1));\n        }\n        subTextArea.appendChild(newSectionButton);\n\n        textEditArea.value = pages[pageName][type][textSection];\n    }\n\n\n    showPageText(\"HTML\");\n\n\n\n\n\n\n    textEditArea.addEventListener(\"input\", () => {\n        pages[pageName][type][textSection] = textEditArea.value;\n        savePages();\n    });\n\n    textEditArea.addEventListener(\"keydown\", function(e) {\n        if (e.key === \"Tab\") {\n            e.preventDefault();\n            const start = this.selectionStart;\n            const end = this.selectionEnd;\n            this.value = this.value.substring(0, start) + \"    \" + this.value.substring(end);\n            this.selectionStart = this.selectionEnd = start + 4;\n        }  \n    });\n\n    showPageButton.onclick = function() {\n        showPage(pageName);\n    };\n\n    savePageButton.onclick = function() {\n        navigator.clipboard.writeText(\"let pages = \" + JSON.stringify(pages, null, 4) + \";\");\n        alert(\"Saved to Clipboard !\");\n    }\n}",
            ""
        ],
        "Notes": ""
    },
    "ClickandTreatTraining": {
        "HTML": [
            "<!--Header--> \n\n<button onclick=\"editPage('ClickandTreatTraining')\">Edit Website Builder</button>\n\n\n<div style=\"height:500px; position:relative; background-color:grey;\">\n    <img style=\"width:160px; height:160px; position:relative; top:30px; left:30px; border-radius:600px;\"></img>\n    <div class=\"fadeUp\">\n        <h1 style=\"color:white;\">Personalised 1-2-1 Dog Training</h1>\n        <p style=\"color:white;\">Building trust, one click at a time!</p>\n    </div>\n</div>\n\n\n<canvas></canvas>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
            "<!--Summary--> \n \n<div class=\"section wrap\" style=\"background-color:#D9F6FA;\">\n    <img class=\"sub\" style=\"width:100%; height:100%; border-radius:400px;\"></img>\n    <div class=\"sub\">\n        <h2>Meet the trainer behind the treats</h2>\n        <p>Hi, I'm Chloe, and I believe in positive reinforcement training. I am passionate about helping dogs and their owners build lasting, trust based relationships.</p>\n        <p>My training methods are force-free, reward-based, and adapted to suit your dog's personality. Whether you're working on puppy foundations, lead skills, recall, reactivity, confidence building, or muzzle training, I'm here to support you every step of the way.</p>\n        <p>My dog, Zuri, is the reason behind everything I do. She is reactive through fear to certain things, and this inspired me to start training. Through our journey, we built a deeper connection, and I found a love for training dogs. Training not only helped her, it strengthened our relationship, helping us become best friends.</p>\n        <p>I offer 1-2-1 dog training and hope to one day expand my business to include a secure dog field and an indoor training space, providing a safe and enriching experience for every dog. </p>\n        <p>Let's train with love and kindness, because good relationships start with trust. </p>\n        <p>I am a registered dog trainer with the <b>Animal Behaviour & Training Council (ABTC)</b>, with over six years of hands-on experience working with and training dogs through two of the UK's largest animal welfare charities.</p>\n        <p>My qualifications include:\n        <ul>\n            <li><b>Canine Behaviour Professional – Accredited Diploma</b></li>\n            <br>\n            <li><b>Canine Reactive Behaviour – Accredited Advanced Certificate</b></li>\n            <br>\n            <li><b>CPD Certified – Canine Fear Course</b></li>\n            <br>\n            <li><b>Animal First Aid Trained</b></li>\n            <br>\n            <li><b>Currently studying</b>: Level 4 Diploma in Canine Welfare, Training & Behaviour</li>\n            <br>\n            <li><b>Professional Member</b> of the <b>National Institute for Canine Ethics</b></li>\n        </ul>\n        <p>With a strong skill set in both practical hands-on experience and academic learning, I am dedicated to promoting ethical, welfare-focused dog training.</p>\n        <div class=\"wrap\" style=\"gap:10px;\">\n            <img></img>\n            <img></img>\n            <img></img>\n        </div>\n    </div>\n</div>\n\n\n<canvas></canvas>",
            "<!--About Me--> \n<div class=\"section wrap\" style=\"background-color:#F0F0F0;\">\n    <h2 style=\"min-width:100%;\">Why choose Click and Treat Training?</h2>\n    <div class=\"card\">\n        <img style=\"width:100%; border-radius:400px;\"></img>\n        <h3>Qualified</h3>\n        <p>I am very committed to continuing to work through CPD to keep up to date with all the latest methods in the dog training world. I am animal first aid trained, meaning I can assist in situations that may arise that I need to. I am a registered dog trainer with the ABTC  (Animal Behaviour & Training Council). I am a part of the International Institute for Canine Ethics, dedicated to promoting humane, respectful, and scientifically based practices in training. As a member, I am responsible for upholding the highest standards of animal ethics, helping to advocate for responsible ownership, and sharing knowledge to improve the lives of dogs.</p>\n    </div>\n    <div class=\"card\">\n        <img style=\"width:100%; border-radius:400px;\"></img>\n        <h3>Supportive</h3>\n        <p>I know how challenging it can be to have a reactive dog, the frustration, the worry, and at times it can feel embarrassing. I’ve been in your shoes. You might wonder if you’re doing enough for your dog, or if you’re doing the right things. I’m here to offer support and understanding every step of the way!</p>\n    </div>\n    <div class=\"card\">\n        <img style=\"width:100%; border-radius:400px;\"></img>\n        <h3>I Love What I Do</h3>\n        <p>I believe training should be positive, practical, and fun. My passion comes from watching dogs thrive and families grow closer through trust, patience, and consistency.</p>\n        <p>Training should be a fun skill and shouldn't feel like a chore.</p>\n        <p>Let's train together and have a good time while achieving goals.</p>\n        <p>I have learnt so much over the years doing what I do, and would love to put this knowledge to good use and help educate dog owners like you.</p>\n        <p>So what are you waiting for? Contact me today and let's begin.</p>\n    </div>\n</div>\n\n\n<canvas></canvas>",
            "<div class=\"section wrap\" style=\"background-color:#F7F3B7;\">\n    <div class=\"sub\"></div>\n    <div class=\"sub\"></div>\n</div>\n\n\n<canvas></canvas>",
            "<div class=\"section wrap\" style=\"background-color:#D9F6FA;\">\n    <div class=\"sub\"></div>\n    <div class=\"sub\"></div>\n</div>\n\n"
        ],
        "CSS": [
            ".section {\n    min-height:200px;\n    width: 90%;\n    padding: 5%;\n    gap: 80px;\n    background-color: grey;\n}\n\n.sub {\n    min-width: 100px;\n    max-width: 500px;\n    min-height: 100px;\n    text-align: center;\n}\n\n.card {\n    width: 100%;\n    max-width:350px;\n    padding: 10px;\n    border:solid black 2px;\n    text-align: center;\n}\n\n\n.wrap {\n    display: flex;\n    flex-wrap: wrap;\n    text-align: center;\n    justify-content: center;\n}\n\n\n\n\n\n\n\n\n\n\n\n.fadeUp {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    transition: all 1s ease-in-out;\n    position: relative;\n    top: 150px;\n    opacity: 0;\n}\n\ncanvas {\n    width: 100%;\n    height: 60px;\n    display: block;\n}\n\nh1, h2, h3, h4, h5 {\n    font-family: \"MyFont1\", sans-serif;\n    text-align: center;\n}\n\n\nh1 {\n    font-size: 64px;\n    margin: 0px;\n}\n\nh2 {\n    font-size: 36px;\n}\n\nh3 {\n    font-size: 28px;\n}\n\np , ul , li {\n    font-family: \"MyFont2\", sans-serif;\n    color: rgb(100,100,100);\n    text-align: left;\n}\n"
        ],
        "JS": [
            "customCSS.innerHTML += `\n    @font-face {\n        font-family: 'MyFont1';\n        src: url('https://clarkent133.github.io/ClickAndTreatTraining/font1.ttf') format('truetype');\n        font-weight: normal;\n        font-style: normal;\n        font-display: swap;\n    }\n    @font-face {\n        font-family: 'MyFont2';\n        src: url('https://clarkent133.github.io/ClickAndTreatTraining/font2.ttf') format('truetype');\n        font-weight: normal;\n        font-style: normal;\n        font-display: swap;\n    }\n\n\n`;\n\nconst backgroundColours = [\n    \"grey\",\n    \"#D9F6FA\",\n    \"#F0F0F0\",\n    \"#F7F3B7\",\n    \"#D9F6FA\",\n    \"grey\"\n]\n\ndocument.querySelectorAll(\"canvas\").forEach((cnv, index) => {\n    const ctx = cnv.getContext(\"2d\");\n    cnv.width = 1000;\n    cnv.height = 500;\n\n    ctx.fillStyle = backgroundColours[index];\n    ctx.fillRect(0, 0, cnv.width, cnv.height);\n\n    ctx.beginPath();\n    ctx.arc(500, 500, 500, 0, Math.PI * 2, false);\n    ctx.fillStyle = backgroundColours[index + 1];\n    ctx.fill();\n\n\n})\n\ndocument.querySelectorAll(\"img\").forEach((elem, index) => {\n    elem.src = \"https://clarkent133.github.io/ClickAndTreatTraining/paw.png\";\n});\n\nrequestAnimationFrame(() => {\n    document.querySelectorAll(\".fadeUp\").forEach((elem, index) => {\n        elem.style.top = \"70px\";\n        elem.style.opacity = 1;\n    })\n});"
        ]
    },
    "KaplayTest": {
        "HTML": [
            ""
        ],
        "CSS": [
            ""
        ],
        "JS": [
            "/* KAPLAY */\n\ncustomHTML.style.display = \"none\";\ndocument.body.style.overflowY = \"hidden\"\n\n\n\nconst k = kaplay({\n    width: 720,\n    height:480,\n    letterbox: true,\n    background: [ 0, 0, 0 ],\n    debugKey: \"p\",\n    global: false,\n    font: \"monospace\"\n});\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
            "/* ASSET LOADING */\n\n\n\nk.loadSprite('ss', 'https://clarkeharrison.co.uk/ss.png', {\n    sliceX: 49,\n    sliceY: 22,\n    anims: {\n\n    }\n});\n\n\n\nk.loadBean();",
            "/* MAIN SCENE */\n\n\n\nk.scene(\"main\", () => {\n\n    const p = k.add([\n        k.sprite(\"ss\", {\n            frame: 1\n        }),\n        k.pos(20, 20)\n    ]);\n\n\n\n    k.add([\n        k.sprite(\"bean\"),\n        k.pos(60, 60)\n    ]);\n\n})\n\nk.go(\"main\");"
        ]
    },
    "RPG Cards": {
        "HTML": [
            "<h1><u>Rules</u></h1>\n<h2><u>What You Need</u></h2>\nEach player needs two six-sided dice, a standard deck of playing cards, and either the companion app or a printable event reference. Damage Counters can be tracked with any tokens or markers.\n<h2><u>Setup</u></h2>\nRemove all Aces through 5s from the deck and separate them by suit. Each player chooses one suit, places the Ace face-up as their Character Card, the area this resides in is your Field. Keep cards 2–5 in hand as Support Cards. Any unused suits are removed from the game. Shuffle the remaining 6–King cards to form the World Deck, where number cards (6–10) are Challenges and face cards (J, Q, K) are Events. Reveal the top three World cards face-up in the center. Begin the adventure in the app and choose who goes first.\n<h2><u>Taking a Turn</u></h2>\nOn your turn you must choose one of the three revealed World cards and do the following:\n<ul>\n    <li>Challenge Card : Roll 2d6 and add +1 for each card in your field that matches the Challenge’s suit. If the total is equal to or greater than the Challenge value you succeed and move the card into your field; if it is lower, you fail, gain one Damage Counter, and discard the card.</li>\n    <br>\n    <li>Event Card : Consult the app or reference sheet, follow its instructions, then discard it. Some Events require a roll such as “2d6 + ♣” or similar. For these perform a Challenge as normal of that suit, but instead of beating a target number, the total is compared to an outcome table shown in the Event.</li>\n</ul>\nAfter resolving the chosen card, reveal a new World card so three are always available. Your turn ends and the next player clockwise begins their turn.\n<h2><u>Supporting Other Players</u></h2>\nBefore the active player rolls for a Challenge, one other player may support them if both agree. The supporting player chooses one of their Support Cards, rolls 1d6, and must roll equal to or higher than the card’s value. On success, the card's value is added to the Challenge roll; on failure, the supporting player gains one Damage. The used Support Card's are then turned face-down and cannot be used again until a \"Rest\" occurs, which is triggered by certain Events.\n<h2><u>Damage, Elimination & Victory</u></h2>\nWhen you gain Damage, place that many Damage Counters onto your Character Card, when it has eight or more, you are out of the game. There is no fixed victory condition; specific Event cards introduce the objective, so the way to win depends entirely on the order in which Events appear.\n<br><br><br><br>\n<h1><u>Card Generator</u></h1>\n<h2>Click to Progress</h2>\n<div id=\"qrcode\" style=\"display:none;\"></div>\n<canvas id=\"cnv\" width=\"250\" height=\"350\" style=\"width:250px; height:350px;\"></canvas>\n<br><br><br><br>\n<button onclick=\"downloadCards();\" style=\"height:auto; width:auto; padding:20px;\">Download All</button>\n<br><br><br><br>"
        ],
        "CSS": [
            ""
        ],
        "JS": [
            "const cnv = document.getElementById(\"cnv\");\nconst ctx = cnv.getContext(\"2d\");\n\n\n\nconst qrCodes = [\"a8@F\",\"K#2p\",\"mZ9!\",\"4g$B\",\"Qw7%\",\"x&L3\",\"R1*t\",\"sE@5\",\"N^6y\",\"c!P8\",\"T0#h\",\"u$K2\",\"V&9z\",\"b3@J\",\"Y*4q\",\"d!M7\",\"G5^x\",\"p#F1\",\"H&8v\",\"j$R6\",\"Z2!n\",\"k@C9\",\"L0#s\",\"w^T3\",\"f&8B\",\"P$6e\",\"o1!Y\",\"X#4m\",\"i^N7\",\"S2@u\",\"e$Q5\",\"U&9h\",\"3b!K\",\"A#6t\",\"g^P8\",\"D0$y\",\"r&4W\",\"J1@c\",\"h!Z9\",\"M#3l\",\"2v^S\",\"E$7o\",\"q&5X\",\"F@8d\",\"6n!G\",\"C#1p\",\"t^4V\",\"B$9r\",\"5L&j\",\"O!2f\",\"7k#H\",\"I^0a\",\"9s$D\",\"l&3U\"];\nconst pc = [\"A♣\",\"2♣\",\"3♣\",\"4♣\",\"5♣\",\"6♣\",\"7♣\",\"8♣\",\"9♣\",\"10♣\",\"J♣\",\"Q♣\",\"K♣\",\"A♥\",\"2♥\",\"3♥\",\"4♥\",\"5♥\",\"6♥\",\"7♥\",\"8♥\",\"9♥\",\"10♥\",\"J♥\",\"Q♥\",\"K♥\",\"A♠\",\"2♠\",\"3♠\",\"4♠\",\"5♠\",\"6♠\",\"7♠\",\"8♠\",\"9♠\",\"10♠\",\"J♠\",\"Q♠\",\"K♠\",\"A♦\",\"2♦\",\"3♦\",\"4♦\",\"5♦\",\"6♦\",\"7♦\",\"8♦\",\"9♦\",\"10♦\",\"J♦\",\"Q♦\",\"K♦\",\"Jo\",\"Jo\"];\nconst COLOURS = ['#ffff00', '#33cc33', '#cc3300', '#0066cc', '#660066', '#ff66ff'];\nconst OFFSET_PAIRS = [\n  [1,2], [1,3], [1,4],\n  [2,1], [2,3], [2,5],\n  [3,1], [3,2], [3,4],\n];\n\nconst DECK = [];\nlet cardID = 1;\nOFFSET_PAIRS.forEach((pair, blockIdx) => {\n    const [a, b] = pair;\n    const bottomPos = blockIdx % 3; // 0,1,2 repeated -> perfect per-colour front position balance\n    for (let c = 0; c < 6; c++) {\n        const bottom = [\n            COLOURS[(c) % 6],\n            COLOURS[(c + a) % 6],\n            COLOURS[(c + a + b) % 6],\n        ];\n        DECK.push({\n            bottom,\n            top: bottom[bottomPos], // top is one of the 3 on its own bottom\n            bottomPos,              // 0 = left, 1 = middle, 2 = right\n        });\n    }\n});\n\n\nfor (let i = DECK.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [DECK[i], DECK[j]] = [DECK[j], DECK[i]]; // swap\n}\n\nfor (let i=0; i<DECK.length; i++) {\n    DECK[i][\"pc\"] = pc[i];\n    DECK[i][\"qr\"] = qrCodes[i];\n}\n\n\n\n\n\n\n\n\n\n\n\nlet count = 0;\ncnv.addEventListener('mousedown', (e) => {\n    count += 1;\n    drawCard(count);\n});\ndrawCard();\n\n\n\n\n\nfunction drawCard(i=0) {\n    const card = DECK[i];\n    ctx.fillStyle = \"black\";\n    ctx.fillRect(0,0,cnv.width,cnv.height);\n\n    drawCircle(20,20,15,card.top);\n    drawCircle(230,20,15,card.top);\n    ctx.fillStyle = card.top;\n    ctx.fillRect(20,5,210,140);\n    ctx.fillRect(5,20,240,125);\n\n    ctx.fillStyle = card.bottom[0];\n    ctx.fillRect(5,145,35,185);\n    ctx.fillRect(20,145,20,200);\n    ctx.fillStyle = card.bottom[1];\n    ctx.fillRect(40,145,170,200);\n    ctx.fillStyle = card.bottom[2];\n    ctx.fillRect(210,145,35,185);\n    ctx.fillRect(210,145,20,200);\n\n    ctx.fillStyle = \"#000000\";\n    ctx.fillRect(75,250,100,100);\n    ctx.fillRect(0,290,250,60);\n\n    ctx.fillStyle = \"#D3D3D3\";\n    ctx.fillRect(5,295,70,35);\n    ctx.fillRect(20,295,55,50);\n    ctx.fillRect(80,255,90,90);\n    ctx.fillRect(175,295,70,35);\n    ctx.fillRect(175,295,55,50);\n\n    drawCircle(20,330,15,\"#D3D3D3\");\n    drawCircle(230,330,15,\"#D3D3D3\");\n\n    drawText(5,295,75,56,`${i + 1}`);\n    drawText(171,295,75,54,card.pc);\n\n    drawShape([ [125,240],[175,240],[185,250],[185,260],[195,270],[225,270],[235,260],[235,25],[225,15],[25,15],[15,25],[15,260],[25,270],[55,270],[65,260],[65,250],[75,240],[125,240] ] , {fill:\"#FFFFFF\"});\n\n    const qrCode = new QRCode(\"qrcode\", {\n        text: card.qr,\n        width: 80,\n        height: 80,\n        colorDark : \"#000000\",\n        colorLight : \"#D3D3D3\",\n        correctLevel : QRCode.CorrectLevel.H\n    });\n\n    ctx.drawImage(qrCode._oDrawing._elCanvas, 85, 260, 80, 80);\n}\n\n\n\n\n\n\n\n\n\n\nfunction drawShape(points, { lineWidth = 5, stroke = '#000', fill = \"\" } = {}) {\n    ctx.beginPath();\n    ctx.moveTo(points[0][0], points[0][1]);\n    for (let i = 1; i < points.length; i++) ctx.lineTo(points[i][0], points[i][1]);\n    ctx.closePath();\n    ctx.lineWidth = lineWidth;\n    ctx.strokeStyle = stroke;\n    ctx.fillStyle = fill;\n    ctx.lineJoin = 'round';\n    ctx.lineCap = 'round';\n    if (fill != \"\") ctx.fill();\n    ctx.stroke();\n}\n\n\nfunction drawCircle(x, y, r, colour, startAngle = 0, endAngle = 360) {\n    ctx.beginPath();\n    ctx.arc(x, y, r, startAngle*(Math.PI / 180), endAngle*(Math.PI / 180));\n    ctx.fillStyle = colour;\n    ctx.fill();\n}\n\n\n\nfunction drawText(x,y,w,h,t,font=\"36px sans-serif\"){\n    ctx.fillStyle=\"#000000\"; ctx.save(); ctx.font=font; ctx.textAlign=\"center\"; ctx.textBaseline=\"alphabetic\";\n  const m=ctx.measureText(\"Mg\"), a=m.actualBoundingBoxAscent||0, d=m.actualBoundingBoxDescent||0,\n        fs=parseFloat(/(\\d+(?:\\.\\d+)?)px/.exec(ctx.font)?.[1]||16),\n        lh=a+d||fs*1.2, asc=a||fs*.8, cx=x+w/2;\n  const wrap=s=>{\n    const L=[], mw=w;\n    for(const p of s.split(/\\r?\\n/)){ let l=\"\";\n      for(const w2 of p.split(/\\s+/)){\n        if(ctx.measureText(w2).width>mw){\n          if(l) L.push(l),l=\"\";\n          let c=\"\"; for(const ch of w2){\n            const t2=c+ch; ctx.measureText(t2).width<=mw?c=t2:(L.push(c),c=ch);\n          } l=c; continue;\n        }\n        const t2=l?l+\" \"+w2:w2;\n        ctx.measureText(t2).width<=mw?l=t2:(L.push(l),l=w2);\n      }\n      L.push(l);\n    } return L;\n  };\n  const lines=wrap(t), bh=lines.length*lh, sy=y+(h-bh)/2+asc;\n  ctx.beginPath(); ctx.rect(x,y,w,h); ctx.clip();\n  lines.forEach((l,i)=>ctx.fillText(l,cx,sy+i*lh));\n  ctx.restore();\n}\n\n\n\nwindow.downloadCards = function() {\n    const tempCnv = document.createElement(\"canvas\");\n    const tempCtx = tempCnv.getContext(\"2d\");\n    const cardWidth = 250;\n    const cardHeight = 350;\n    tempCnv.width = cardWidth * 4;\n    tempCnv.height = cardHeight * 14;\n    for (let i=0; i<54; i++) {\n        drawCard(i);\n        tempCtx.drawImage(cnv, Math.floor(i%4)*250, Math.floor(i/4)*350);\n    }\n    drawCard(0);\n    const link = document.createElement('a');\n    link.download = 'cards.png';\n    link.href = tempCnv.toDataURL('image/png');\n    link.click();\n}\n\n\n\n"
        ]
    },
    "Study Map": {
        "HTML": [
            "<div id=\"card\">\n    <button id=\"QuestionButton\">Q</button>\n    <h1 id=\"Title\">Title</h1>\n    <div id=\"Contents\">Text</div>\n</div>"
        ],
        "CSS": [
            "#card {\n    width: calc(100% - 168px);\n    height: calc(100% - 168px);\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    padding: 40px;\n    margin: 40px;\n    justify-content: center;\n    align-items: center;    \n    border: solid black 4px;\n    border-radius: 8px;\n    box-shadow: 4px 4px 6px black;\n    font-size: 1.4rem;\n}\n\n#Contents {\n    height: 100%;\n    width: 100%;\n    overflow-y: auto;\n    scrollbar-width: none;\n}\n\n#card button {\n    width: 40px;\n    height: 40px;\n    position: absolute;\n    top: 10px;\n    right: 10px;\n    border: solid black 2px;\n    border-radius: 8px;\n    box-shadow: 2px 2px 4px black;\n    font-size: 32px;\n    cursor: pointer;\n}\n\n.quizElem {\n    border:solid black 1px;\n    border-radius:8px;\n    width:calc(100% - 42px);\n    height: auto;\n    padding:20px;\n    text-align:center;\n    margin-top: 20px;\n}\n\nhr {\n    margin: 40px;\n}"
        ],
        "JS": [
            "const cards = {\n    \"Clarke\": [\n        \"Hi, I'm Clarke.<br><br>This is the starting page for my Study Guide\", \n        [\"What is 2+2?\", \"4\", \"3\", \"Incorrect, the answer is 4\"], \n        [\"What color is the sky?\", \"Blue\", \"Green\", \"Incorrect, the answer is Blue\"]\n    ],\n    \"Bob\": [\"I am Bob. Previous was Clarke.\", []]\n};\n\nconst title = document.querySelector(\"#Title\");\nconst contents = document.querySelector(\"#Contents\");\nconst questionButton = document.querySelector(\"#QuestionButton\");\n\nwindow.showCard = function(card) {\n    title.innerHTML = card;\n\n    let txt = cards[card][0]; // Intro text\n    contents.innerHTML = txt;\n\n    Object.keys(cards).forEach((key) => {\n        if (key !== card) {\n            const regex = new RegExp(key, \"gi\");\n            txt = txt.replace(regex, (match) => {\n                return `<a href=\"#\" onclick=\"showCard('${key}'); return false;\">${match}</a>`;\n            });\n        }\n    });\n    contents.innerHTML = txt;\n\n    const ary = cards[card].slice(1); // Questions array for this card\n\n    questionButton.onclick = function() {\n        if (ary.length > 0) showQuestion(0, ary);\n    };\n\n    function showQuestion(i, questions) {\n        const q = questions[i];\n        contents.innerHTML = \"\";\n\n        const quesText = q[0];\n        const resultText = q[q.length - 1];\n        const answers = q.slice(1, q.length - 1);\n\n        const answerObjs = answers.map((ans, idx) => ({\n            text: ans,\n            correct: idx === 0\n        }));\n\n        // Shuffle answers\n        for (let x = answerObjs.length - 1; x > 0; x--) {\n            const y = Math.floor(Math.random() * (x + 1));\n            [answerObjs[x], answerObjs[y]] = [answerObjs[y], answerObjs[x]];\n        }\n\n        const ques = document.createElement(\"div\");\n        ques.classList.add(\"quizElem\");\n        ques.innerHTML = quesText;\n        contents.appendChild(ques);\n        contents.appendChild(document.createElement(\"hr\"));\n\n        answerObjs.forEach((ansObj) => {\n            const answer = document.createElement(\"div\");\n            answer.classList.add(\"quizElem\");\n            answer.innerHTML = ansObj.text;\n            answer.style.cursor = \"pointer\";\n\n            answer.onclick = function () {\n                if (ansObj.correct) {\n                    answer.innerHTML = resultText;\n                    answer.style.backgroundColor = \"rgb(10,100,10)\";\n                    answer.style.color = \"white\";\n                    answer.onclick = function () {\n                        if (i === questions.length - 1) return showCard(card);\n                        return showQuestion(i + 1, questions); // Pass questions again\n                    };\n                } else {\n                    answer.style.backgroundColor = \"rgb(100,10,10)\";\n                    answer.style.color = \"white\";\n                }\n            };\n\n            contents.appendChild(answer);\n        });\n    }\n};\n\n\nshowCard(\"Clarke\");\n"
        ]
    }
};

            const customHTML = document.getElementById("customHTML");
            const customCSS = document.getElementById("customCSS");

            function showPage(pageName="Home") {
                customHTML.style.opacity = 0;
                setTimeout(() => {
                    customHTML.innerHTML = pages[pageName]["HTML"].join("\n");
                    customCSS.innerHTML = pages[pageName]["CSS"].join("\n");
                    new Function(pages[pageName]["JS"].join("\n"))();
                    requestAnimationFrame(() => {customHTML.style.opacity = 1;})
                }, 300);
            }

            async function savePages(save = true) {
                const db = await new Promise((res, rej) => {
                    const r = indexedDB.open("pagesDB", 1);
                    r.onupgradeneeded = () => r.result.createObjectStore("pagesDB");
                    r.onsuccess = () => res(r.result);
                    r.onerror = () => rej(r.error);
                });

                const tx = db.transaction("pagesDB", "readwrite");
                const store = tx.objectStore("pagesDB");
                const key = "pages";

                return new Promise((res, rej) => {
                    const req = save ? store.put(pages, key) : store.get(key);
                    req.onsuccess = () => {
                        if (!save) {
                            if (req.result) pages = req.result;
                            showPage();
                        }
                        res(req.result);
                    };
                    req.onerror = () => rej(req.error);
                });
            }

            savePages(false);

        </script>

        <script>
            // if ("serviceWorker" in navigator) {
            //     navigator.serviceWorker.register("/service-worker.js");
            // }
        </script>
    </body>
</html>
